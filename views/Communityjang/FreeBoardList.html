<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<title>S.F</title>
	<!-- Favicon-->
	<link rel="icon" type="image/x-icon" href="../../resources/assets/favicon.ico" />
	<!-- Bootstrap icons-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet"
		type="text/css" />
	<!-- Google fonts-->
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet"
		type="text/css" />
	<!-- Core theme CSS (includes Bootstrap)-->
	<link href="../../resources/css/styles.css" rel="stylesheet" />

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- Core theme JS-->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="../../resources/js/scripts.js"></script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<link rel="stylesheet" href="../../resources/css/boardcss.css">
	<link rel="stylesheet" href="../../resources/css/Main.css">

	
		
</head>

<body>
	<!-- Navigation-->
	<div>

		<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
			<div class="container px-4 px-lg-5" style="margin-top: 10px;">
				<a class="navbar-brand" href="/home/main">S.F</a>
				<button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse"
					data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
					aria-label="Toggle navigation">

					<i class="fas fa-bars"></i>
				</button>
				<div class="collapse navbar-collapse" id="navbarResponsive">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">동호회소개</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="/home/leisure">레져</a></li>
								<li><a class="dropdown-item" href="/home/travel">여행</a></li>
								<li><a class="dropdown-item" href="/home/exercise">운동</a></li>
								<li><a class="dropdown-item" href="/home/study">스터디</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">동호회신청</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="#!"></a></li>
								<li><a class="dropdown-item" href="/home/newclub">동호회
										신청</a></li>
								<li><a class="dropdown-item" href="/home/newclubapply">
										신규동호회 등록</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">커뮤니티</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="#!">자유게시판</a></li>
								<li><a class="dropdown-item" href="#!">Q&A</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">마이페이지</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="/home/mypage">회원 정보
										관리</a></li>
								<li><a class="dropdown-item" href="/home/mypage">동호회 신청
										현황</a></li>
							</ul>
						</li>

						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">관리자
								메뉴</a>
							<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="/admin/freeboard">게시판
										관리</a></li>
								<li><a class="dropdown-item" href="/admin/qnaboard">Q&A관리</a></li>
								<li><a class="dropdown-item" href="/admin/member_registration">신규 회원 등록</a></li>
								<li><a class="dropdown-item" href="/admin/member_management">회원 관리</a></li>
								<li><a class="dropdown-item" href="/admin/club_Applist">동호회 신청 목록</a></li>
								<li><a class="dropdown-item" href="/admin/club_management">동호회
										관리</a></li>
							</ul>
						</li>

						<div id="login" style="position: absolute; top: 0px; right: 150px;">
							<ul style="list-style: none; display: flex; text-decoration: none; color: black;">
								<a href="/home/main" style="color: black;">
									<li>홈</li>
								</a>
								<li>|</li>
								<a href="/home/login" style="color: black;">
									<li>로그인</li>
								</a>
								<li>|</li>
								<a href="/home/join_check" style="color: black;">
									<li>회원가입</li>
								</a>
								<li>|</li>
								<a href="/admin/home" style="color: black;">
									<li>관리자</li>
								</a>
							</ul>
						</div>
					</ul>
				</div>
			</div>
		</nav>
	</div>
	<link rel="stylesheet" href="../../resources/css/Main.css">


	<div class="container" style="padding-top: 150px;">
		<img src="../resources/images/study.jpg" width="100%" height="600">
		<h3>
			<span class="badge bg-secondary text-bg-info">자유게시판</span>
		</h3>
	</div>


	<div class="container">
		<form id="listForm" action="/qnaboard/qnalist" method="post">     
			<div class="table-group">
				<table  style="width: 100%; padding: 2px; border: 1px solid;" >
					<tr>
						<th style="text-align: center; width: 70px; background-color: #6666; ">검색</th>
						
					   <td class="table_free_cus ser">																			
						   <!-- <select	name="type" data-msg="선택해주세요." required> -->
						   <select name="type" class="search">
						   <option value=""<c:if test="${board.type == ''}">selected="selected"</c:if>>전체검색</option>
						   <option value="title"<c:if test="${board.type == 'title'}">selected="selected"</c:if>>제목</option>
						   <option value="content"<c:if test="${board.type == 'content'}">selected="selected"</c:if>>내용</option>
						   </select> 
						   <input  class="search" type="text" name='keyword' value='<c:out value="${ board.keyword }" />' data-msg="입력해주세요."/><!--  required -->
						   <input type='hidden' name='pageNum' value='<c:out value="${ board.pageNum }" />' />
						   <input type='hidden' name='amount' value='<c:out value="${ board.amount }" />' /> 
						   <button class='btn  list_btn' onclick="search();">검색하기</button>
						</td>
		   
						<th style="text-align: center; width: 70px; background-color: #6666; ">카테고리</th>
						
					   <td class="table_free_cus">
						   <select class="search" id="cate_num" name="cate_num">
						   <option value="">--카테고리 선택--</option> 
						   <c:forEach items="${cateList}" var="category">
						   <option value="${category.cate_num}"<c:if test="${category.cate_num == board.cate_num}">selected="selected"</c:if>>${category.cate_kind}</option>
						   </c:forEach>
						   </select>
						</td>
					
					<th><button id="writeForm" class="btn  list_btn onclick="location.href='../qnaboard/qnaregisterProc'">작성하기</button></th>			
					
					</tr>
				</table>
				<!-- 게시물 목록 테이블(표) -->
				<table class="table table-striped" style="width: 100%;">

					<tr style="text-align: center;">
						<th>번호</th>
						<th>유형</th>
						<th>제목</th>
						<th>작성자</th>
						<th>작성일</th>
						<th></th>
						<th>첨부파일</th>
					</tr>


					<c:forEach items="${list}" var="board">
						<tr>
							<td class="align-middle align-middle text-center ">
								<c:out value="${board.bno}" />
							</td>
							<td class="align-middle align-middle ">
								<c:out value="${board.cate_kind}" />
							</td>
							<td class="align-middle align-middle">
								<a href="/board/read?bno=${board.bno }">
									<c:out value="${board.title}" />
								</a>
							</td>
							<td class="align-middle align-middle">
								<c:out value="${board.id}" />
							</td>
							<td class="align-middle align-middle">
								<fmt:formatDate value="${board.reg_date}" pattern="yyyy-MM-dd" />
							</td>
							<td class="text-center align-middle">
								<div class="btn-group align-top">
							<td class="text-center">
								<button type="button" class="btn btn-primary btn-sm">첨부파일</button>
							</td>
							<!-- </form> -->
			</div>
			</td>
			</tr>
			</c:forEach>
			</table>
	</div>
	</form>
	</div>

	<!-- 페이징 처리 -->
	<div class='pull-right'>
		<ul class="pagination">
			<c:if test="${pageMaker.prev}">
				<li class="paginate_button previous"><a href="${ pageMaker.startPage-1 }">Previous</a>
				</li>
			</c:if>

			<c:forEach var="num" begin="${pageMaker.startPage}" end="${pageMaker.endPage}">
				<li class="paginate_button ${ pageMaker.cri.pageNum == num ? " active":"" } "><a href=" ${ num }">
					${num}</a></li>
			</c:forEach>

			<c:if test="${pageMaker.next}">
				<li class="paginate_button next"><a href="${ pageMaker.endPage + 1 }">Next</a></li>
			</c:if>
		</ul>
	</div>

	<!-- Modal  추가 -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="myModalLabel">Modal title</h4>
				</div>
				<div class="modal-body">처리가 완료되었습니다.</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- /.modal -->
	    <!-- 사이드바 맨위 맨아래 -->
<a style="display:scroll;position:fixed;bottom:80px; right:30px;" rel="nofollow"
href="#" style="font-size:2.0em">▲</a>
<a style="display:scroll;position:fixed;bottom:40px; right:30px;" rel="nofollow"
href="#scrollbottom" style="font-size:2.0em">▼</a>
<div id="scrollbottom"></div>

	<script type="text/javascript">
		$(document).ready(function () {

			var result = '<c:out value="${result}"/>';

			checkModal(result);

			history.replaceState({}, null, null);

			function checkModal(result) {
				if (result === '' || history.state) {
					return;
				}

				if (parseInt(result) > 0) {
					$(".modal-body").html(
						"게시글 " + parseInt(result)
						+ "번이 등록되었습니다.");
				}
				$("#myModal").modal("show");  //모달 창 출력 
			}

			/* $("#regBtn").on("click", function() {
				self.location = "/board/register";
			}); */

			//페이징처리
			var listForm = $("#listForm");
			$(".paginate_button a").on("click", function (e) {
				e.preventDefault();
				//console.log("click");
				//listForm.find("input[name='pageNum']").val($(this).attr("href"));
				$("input[name='pageNum']").val($(this).attr("href"));
				listForm.submit();
			});

			/* 게시물의 제목을 클릭했을 떄 이동하도록 이벤트 처리 */
			$("#move").on("click", function (e) {
				e.preventDefault();
				actionForm
					.append("<input type='hidden' name='bno' value='" + $(this).attr("href") + "'>");
				actionForm.attr("action", "/board/read?bno=" + $("#bno").val());
				actionForm.submit();
			});

			/* 게시물의 작성하기 클릭했을때 작성하기 폼으로 이동하는 이벤트 처리 */
			$("#writeForm").on("click", function (e) {
				e.preventDefault();
				actionForm
					.append("<input type='hidden' name='bno' value='" + $(this).attr("href") + "'>");
				actionForm.attr("action", "../board/register");
				actionForm.submit();
			});


			/* $("#cate_num").change(function(){
				$("#listForm").submit();
				  }); */
		});


		//게시글 검색
		function search() {

			var name;

			$('#listForm').find('select, input').each(function () {

				if (!$(this).prop('required')) {	//required 속성이 없을때

				} else {	//required 속성이 있을때
					if ($(this).val() == "") {
						//alert($( this ).attr( 'name' ) +"val"+ $(this).val());
						var msg = $(this).data("msg");
						alert(msg);
						//name = $( this ).attr( 'name' );
						//fail_log += name + " is required \n";

						return false;
					}

				}
			});
			//검색할때..1부터 다시 검색해야 제대로 나오니까..1로 하는거야
			//검색할땐 당연히 검색조건이 변경되거나 그대로 일수있으니까 1로 주는거..1~10까지 이렇게
			$("input[name='pageNum']").val(1);

			//$("#listForm").attr("action","/board/list").submit();
		}


		/* ajax선언 */
		$.ajax({
			url: '/list',
			processData: false,
			contentType: false,
			data: formData,
			type: 'POST',
			dataType: 'json',
			success: function (result) {
				console.log(result);
			}
		});


	</script>